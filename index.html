<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POE Builds & Money Strategies</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #e94560;
            --accent-light: #ff6b6b;
            --text: #eee;
            --text-muted: #aaa;
            --gold: #d4af37;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            border-bottom: 2px solid var(--accent);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: var(--gold);
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            border: 2px solid var(--accent);
            background: transparent;
            color: var(--accent);
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .tab-btn:hover, .tab-btn.active {
            background: var(--accent);
            color: var(--primary);
        }

        .content {
            display: none;
        }

        .content.active {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--secondary);
            border: 2px solid var(--accent);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.3);
            border-color: var(--accent-light);
        }

        .card h3 {
            color: var(--gold);
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .card p {
            color: var(--text-muted);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .card-tag {
            display: inline-block;
            background: var(--accent);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            margin-right: 8px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .card-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--primary);
        }

        .btn-primary:hover {
            background: var(--accent-light);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--text-muted);
            color: var(--text-muted);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-bar input {
            padding: 10px 15px;
            background: var(--secondary);
            border: 1px solid var(--accent);
            color: var(--text);
            border-radius: 4px;
            flex: 1;
            min-width: 200px;
        }

        .filter-bar input::placeholder {
            color: var(--text-muted);
        }

        .filter-btn {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--accent);
            color: var(--accent);
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--accent);
            color: var(--primary);
        }

        .version-group {
            margin-bottom: 30px;
        }

        .version-header {
            background: linear-gradient(90deg, var(--accent) 0%, transparent 100%);
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--gold);
            font-size: 1.3em;
            font-weight: bold;
            color: var(--gold);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state p {
            font-size: 1.1em;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .content.active {
                grid-template-columns: 1fr;
            }

            .tabs {
                gap: 5px;
            }

            .tab-btn {
                padding: 10px 16px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>⚔️ POE Builds & Money Strategies</h1>
            <p class="subtitle">Path of Exile 1 - Complete Build & Farming Guide</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('builds')">Builds</button>
            <button class="tab-btn" onclick="switchTab('money')">Money Strategies</button>
        </div>

        <!-- BUILDS TAB -->
        <div id="builds" class="content active">
            <div style="grid-column: 1 / -1;">
                <div class="filter-bar">
                    <input type="text" id="buildSearch" placeholder="Search builds..." onkeyup="filterBuilds()">
                </div>
            </div>
            <div id="buildsContainer" style="grid-column: 1 / -1;"></div>
        </div>

        <!-- MONEY STRATEGIES TAB -->
        <div id="money" class="content">
            <div style="grid-column: 1 / -1;">
                <div id="moneyContainer"></div>
            </div>
        </div>
    </div>

    <script>
        const GITHUB_REPO = 'alex938/poe_builds';
        const GITHUB_RAW = 'https://raw.githubusercontent.com/alex938/poe_builds/main/poe1';
        const GITHUB_WEB = 'https://github.com/alex938/poe_builds/tree/main/poe1';

        let allBuilds = [];

        async function fetchData() {
            try {
                // Fetch builds
                const buildsResponse = await fetch(`${GITHUB_RAW}/Builds`);
                if (!buildsResponse.ok) throw new Error('Failed to fetch builds');

                // Parse builds from GitHub API
                const buildsApiUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/poe1/Builds`;
                const buildsApi = await fetch(buildsApiUrl);
                const buildFiles = await buildsApi.json();

                allBuilds = buildFiles
                    .filter(f => f.name.endsWith('.xml'))
                    .map(f => ({
                        name: f.name.replace('.xml', ''),
                        file: f.name,
                        path: f.path,
                        url: f.html_url,
                        downloadUrl: f.download_url
                    }))
                    .sort((a, b) => b.name.localeCompare(a.name));

                displayBuilds(allBuilds);

                // Fetch money strategies
                const moneyApiUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/poe1/money_strats`;
                const moneyApi = await fetch(moneyApiUrl);
                const moneyFiles = await moneyApi.json();

                const strategyCards = moneyFiles
                    .filter(f => f.name.endsWith('.md'))
                    .map(f => ({
                        name: f.name.replace('.md', '').replace(/_/g, ' ').toUpperCase(),
                        url: f.html_url,
                        rawUrl: f.download_url
                    }));

                displayMoney(strategyCards);
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('buildsContainer').innerHTML = 
                    '<div class="empty-state"><p>Error loading builds. Please try again later.</p></div>';
            }
        }

        function displayBuilds(builds) {
            const container = document.getElementById('buildsContainer');
            
            if (builds.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>No builds found matching your search.</p></div>';
                return;
            }

            // Group by patch version
            const grouped = {};
            builds.forEach(build => {
                const match = build.name.match(/3\.\d+/);
                const version = match ? match[0] : 'Other';
                if (!grouped[version]) grouped[version] = [];
                grouped[version].push(build);
            });

            // Sort versions descending
            const sortedVersions = Object.keys(grouped).sort((a, b) => parseFloat(b) - parseFloat(a));

            container.innerHTML = sortedVersions.map(version => `
                <div style="grid-column: 1 / -1;">
                    <div class="version-header">Patch ${version}</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;">
                        ${grouped[version].map(build => `
                            <div class="card">
                                <h3>${build.name}</h3>
                                <div class="card-tag">${version}</div>
                                <p>Click to view or download this build</p>
                                <div class="card-buttons">
                                    <a href="${build.url}" target="_blank" class="btn btn-primary" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">View on GitHub</a>
                                    <a href="${build.downloadUrl}" download class="btn btn-secondary" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">Download</a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function displayMoney(strategies) {
            const container = document.getElementById('moneyContainer');
            container.innerHTML = strategies.map(strat => `
                <div class="card" style="grid-column: 1 / -1; margin-bottom: 20px;">
                    <h3>${strat.name}</h3>
                    <p>Farming strategy with details, screenshots, and atlas tree information</p>
                    <div class="card-buttons">
                        <a href="${strat.url}" target="_blank" class="btn btn-primary" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">View on GitHub</a>
                    </div>
                </div>
            `).join('');
        }

        function filterBuilds() {
            const searchTerm = document.getElementById('buildSearch').value.toLowerCase();
            const filtered = allBuilds.filter(build => build.name.toLowerCase().includes(searchTerm));
            displayBuilds(filtered);
        }

        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Load data on page load
        fetchData();
    </script>
</body>
</html>
